"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1503],{1503:(v,u,n)=>{n.r(u),n.d(u,{MessagesPageModule:()=>P});var a=n(6895),f=n(433),i=n(5035),d=n(1407),g=n(655),m=n(6534),e=n(8256);const M=function(o){return{"background-color":o}};function h(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",2),e.NdJ("click",function(){const p=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.presentAlert(p.report.toString()))}),e._uU(1),e.qZA()}if(2&o){const t=s.$implicit,r=e.oxw();e.Q6J("ngStyle",e.VKq(2,M,r.getButtonColor(t.report))),e.xp6(1),e.Oqu(r.getErrorTitle(t.report.toString()))}}const y=[{path:"",component:(()=>{class o{constructor(t){this.alertController=t,this.logs=[]}ngOnInit(){this.getLogsFromServer(),setInterval(()=>{this.getLogsFromServer()},5e3)}getLogsFromServer(){return(0,g.mG)(this,void 0,void 0,function*(){try{const t=yield this.getLogs();this.logs=t}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430:",t)}})}presentAlert(t){return(0,g.mG)(this,void 0,void 0,function*(){const r=this.getErrorByCode(t);r&&(yield(yield this.alertController.create({header:`\u041e\u0448\u0438\u0431\u043a\u0430 ${t}`,subHeader:r.title,message:r.description,buttons:["OK"]})).present())})}getErrorByCode(t){return[{code:"16",title:"\u0417\u0430\u0436\u0430\u0442\u0438\u0435",description:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0430 \u0442\u0435\u0445\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 - \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f"},{code:"10",title:"\u041f\u0435\u0440\u0435\u0433\u0440\u0435\u0432",description:"\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0440\u0430\u0431\u043e\u0442\u0443 \u043d\u0430 \u0432\u0440\u0435\u043c\u044f, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0440\u0430\u0431\u043e\u0442\u043e\u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c \u0432 \u0445\u043e\u043b\u043e\u0441\u0442\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435"},{code:"8",title:"\u041f\u0430\u0434\u0435\u043d\u0438\u0435 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438",description:"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u0443\u0436\u043a\u0438 \u043d\u0430 \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440\u043d\u043e\u0439 \u043b\u0435\u043d\u0442\u0435"},{code:"6",title:"\u0423\u043c\u0435\u043d\u044c\u0448\u0435\u043d\u0438\u0435 \u0442\u043e\u043a\u0430",description:"\u041e\u0442\u0440\u0435\u0433\u0443\u043b\u0438\u0440\u0443\u0439\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u0443\u0436\u043a\u0438"},{code:"12",title:"\u0423\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435 \u0442\u043e\u043a\u0430",description:"\u041e\u0442\u0440\u0435\u0433\u0443\u043b\u0438\u0440\u0443\u0439\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u0430 \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u0443\u0436\u043a\u0438"}].find(c=>c.code===t)}getLogs(t=1){return(0,g.mG)(this,void 0,void 0,function*(){try{const r=yield m.Z.get(`https://api-aggregate.s-k56.ru/api/get-logs?id_machine=${t}`);return console.log("\u0423\u0441\u043f\u0435\u0448\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442 \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430:",r.data),r.data.filter(l=>this.isError(l.report))}catch(r){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u0430:",r),[]}})}isError(t){return["16","10","8","6","12"].includes(t.toString())}getErrorTitle(t){const r=this.getErrorByCode(t);return r?`${r.title.charAt(0).toUpperCase()}${r.title.slice(1).toLowerCase()}`:""}getButtonColor(t){switch(t.toString()){case"16":return"orange";case"10":return"red";case"8":return"yellow";case"6":return"gray";case"12":return"blue";default:return""}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(i.Br))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-messages"]],decls:6,vars:1,consts:[["color","tertiary"],["expand","full",3,"ngStyle","click",4,"ngFor","ngForOf"],["expand","full",3,"ngStyle","click"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3," \u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f "),e.qZA()()(),e.TgZ(4,"ion-content"),e.YNc(5,h,2,4,"ion-button",1),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngForOf",r.logs.reverse()))},dependencies:[a.sg,a.PC,i.YG,i.W2,i.Gu,i.wd,i.sr],styles:["ion-button[_ngcontent-%COMP%]{text-transform:capitalize}.red-button[_ngcontent-%COMP%]{--background: red}.orange-button[_ngcontent-%COMP%]{--background: orange}.gray-button[_ngcontent-%COMP%]{--background: gray}.blue-button[_ngcontent-%COMP%]{--background: blue}.yellow-button[_ngcontent-%COMP%]{--background: yellow}"]}),o})()}];let C=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.Bz.forChild(y),d.Bz]}),o})(),P=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[a.ez,f.u5,i.Pc,C]}),o})()}}]);